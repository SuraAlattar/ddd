<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Animated Product Slider | Lundev Store</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --item1-transform: translateX(-100%) translateY(-5%) scale(1.5);
      --item1-filter: blur(30px);
      --item1-zIndex: 11;
      --item1-opacity: 0;

      --item2-transform: translateX(0);
      --item2-filter: blur(0px);
      --item2-zIndex: 10;
      --item2-opacity: 1;

      --item3-transform: translate(50%,10%) scale(0.8);
      --item3-filter: blur(10px);
      --item3-zIndex: 9;
      --item3-opacity: 1;

      --item4-transform: translate(90%,20%) scale(0.5);
      --item4-filter: blur(30px);
      --item4-zIndex: 8;
      --item4-opacity: 1;
      
      --item5-transform: translate(120%,30%) scale(0.3);
      --item5-filter: blur(40px);
      --item5-zIndex: 7;
      --item5-opacity: 0;

      --brand: #693EFF;
      --ink: #222;
      --muted: #555;
      --bg: #F4F4F4;
      --card: #fff;
      --border: #e8e8e8;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{margin:0;background-color:var(--bg);font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";color:var(--ink)}

    /* Header */
    header{position:sticky;top:0;z-index:1000;backdrop-filter:blur(8px);background:rgba(255,255,255,.6);border-bottom:1px solid var(--border)}
    .navwrap{width:1140px;max-width:95%;margin:auto;height:64px;display:flex;align-items:center;justify-content:space-between}
    .logo{font-weight:800;letter-spacing:.5px}
    nav a{margin-left:24px;text-decoration:none;color:#444;font-weight:500}
    .actions{display:flex;align-items:center;gap:10px}
    .btn{padding:10px 14px;border:1px solid var(--border);background:#fff;border-radius:10px;font-weight:600;cursor:pointer}
    .btn.primary{background:var(--brand);color:#fff;border-color:transparent}

    /* HERO / CAROUSEL */
    .hero{padding-top:10px}
    .carousel{position:relative;height:800px;overflow:hidden;margin-top:-10px}
    .carousel .list{position:absolute;width:1140px;max-width:90%;height:80%;left:50%;transform:translateX(-50%)}
    .carousel .list .item{position:absolute;left:0%;width:70%;height:100%;font-size:15px;transition:left .5s,opacity .5s,width .5s}
    .carousel .list .item:nth-child(n + 6){opacity:0}
    .carousel .list .item:nth-child(2){z-index:10;transform:translateX(0)}
    .carousel .list .item img{width:50%;position:absolute;right:0;top:50%;transform:translateY(-50%);transition:right 1.5s}
    .carousel .list .item .introduce{opacity:0;pointer-events:none}
    .carousel .list .item:nth-child(2) .introduce{opacity:1;pointer-events:auto;width:400px;position:absolute;top:50%;transform:translateY(-50%);transition:opacity .5s}
    .carousel .list .item .introduce .title{font-size:2em;font-weight:500;line-height:1em}
    .carousel .list .item .introduce .topic{font-size:4em;font-weight:600}
    .carousel .list .item .introduce .des{font-size:.9em;color:#5559}
    .seeMore{margin-top:1.2em;padding:10px 14px;border:1px solid #ddd;background:#fff;font-weight:600;letter-spacing:2px;border-radius:10px}
    .seeMore:hover{background:#f4f4f4}

    .carousel .list .item:nth-child(1){transform:var(--item1-transform);filter:var(--item1-filter);z-index:var(--item1-zIndex);opacity:var(--item1-opacity);pointer-events:none}
    .carousel .list .item:nth-child(3){transform:var(--item3-transform);filter:var(--item3-filter);z-index:var(--item3-zIndex)}
    .carousel .list .item:nth-child(4){transform:var(--item4-transform);filter:var(--item4-filter);z-index:var(--item4-zIndex)}
    .carousel .list .item:nth-child(5){transform:var(--item5-transform);filter:var(--item5-filter);opacity:var(--item5-opacity);pointer-events:none}

    /* animation text in item2 */
    .carousel .list .item:nth-child(2) .introduce .title,
    .carousel .list .item:nth-child(2) .introduce .topic,
    .carousel .list .item:nth-child(2) .introduce .des,
    .carousel .list .item:nth-child(2) .introduce .seeMore{opacity:0;animation:showContent .5s 1s ease-in-out 1 forwards}
    @keyframes showContent{from{transform:translateY(-30px);filter:blur(10px)}to{transform:translateY(0);opacity:1;filter:blur(0)}}
    .carousel .list .item:nth-child(2) .introduce .topic{animation-delay:1.2s}
    .carousel .list .item:nth-child(2) .introduce .des{animation-delay:1.4s}
    .carousel .list .item:nth-child(2) .introduce .seeMore{animation-delay:1.6s}

    /* next click */
    .carousel.next .item:nth-child(1){animation:transformFromPosition2 .5s ease-in-out 1 forwards}
    @keyframes transformFromPosition2{from{transform:var(--item2-transform);filter:var(--item2-filter);opacity:var(--item2-opacity)}}
    .carousel.next .item:nth-child(2){animation:transformFromPosition3 .7s ease-in-out 1 forwards}
    @keyframes transformFromPosition3{from{transform:var(--item3-transform);filter:var(--item3-filter);opacity:var(--item3-opacity)}}
    .carousel.next .item:nth-child(3){animation:transformFromPosition4 .9s ease-in-out 1 forwards}
    @keyframes transformFromPosition4{from{transform:var(--item4-transform);filter:var(--item4-filter);opacity:var(--item4-opacity)}}
    .carousel.next .item:nth-child(4){animation:transformFromPosition5 1.1s ease-in-out 1 forwards}
    @keyframes transformFromPosition5{from{transform:var(--item5-transform);filter:var(--item5-filter);opacity:var(--item5-opacity)}}

    /* prev */
    .carousel.prev .list .item:nth-child(5){animation:transformFromPosition4 .5s ease-in-out 1 forwards}
    .carousel.prev .list .item:nth-child(4){animation:transformFromPosition3 .7s ease-in-out 1 forwards}
    .carousel.prev .list .item:nth-child(3){animation:transformFromPosition2 .9s ease-in-out 1 forwards}
    .carousel.prev .list .item:nth-child(2){animation:transformFromPosition1 1.1s ease-in-out 1 forwards}
    @keyframes transformFromPosition1{from{transform:var(--item1-transform);filter:var(--item1-filter);opacity:var(--item1-opacity)}}

    /* detail  */
    .detail{opacity:0;pointer-events:none}
    .carousel.showDetail .list .item:nth-child(3),
    .carousel.showDetail .list .item:nth-child(4){left:100%;opacity:0;pointer-events:none}
    .carousel.showDetail .list .item:nth-child(2){width:100%}
    .carousel.showDetail .list .item:nth-child(2) .introduce{opacity:0;pointer-events:none}
    .carousel.showDetail .list .item:nth-child(2) img{right:50%}
    .carousel.showDetail .list .item:nth-child(2) .detail{opacity:1;width:50%;position:absolute;right:0;top:50%;transform:translateY(-50%);text-align:right;pointer-events:auto}
    .carousel.showDetail .list .item:nth-child(2) .detail .title{font-size:3rem}
    .carousel.showDetail .list .item:nth-child(2) .detail .specifications{display:flex;gap:10px;width:100%;border-top:1px solid #5553;margin-top:20px}
    .carousel.showDetail .list .item:nth-child(2) .detail .specifications div{width:90px;text-align:center;flex-shrink:0}
    .carousel.showDetail .list .item:nth-child(2) .detail .specifications div p:nth-child(1){font-weight:bold}
    .carousel.showDetail .list .item:nth-child(2) .detail .checkout button{background:#fff;border:1px solid #ddd;margin-left:5px;padding:8px 12px;letter-spacing:1px;font-weight:600;border-radius:10px}
    .carousel.showDetail .list .item:nth-child(2) .detail .checkout button:nth-child(2){background-color:var(--brand);color:#fff;border-color:transparent}
    .carousel.showDetail .list .item:nth-child(2) .detail .title,
    .carousel.showDetail .list .item:nth-child(2) .detail .des,
    .carousel.showDetail .list .item:nth-child(2) .detail .specifications,
    .carousel.showDetail .list .item:nth-child(2) .detail .checkout{opacity:0;animation:showContent .5s 1s ease-in-out 1 forwards}
    .carousel.showDetail .list .item:nth-child(2) .detail .des{animation-delay:1.2s}
    .carousel.showDetail .list .item:nth-child(2) .detail .specifications{animation-delay:1.4s}
    .carousel.showDetail .list .item:nth-child(2) .detail .checkout{animation-delay:1.6s}

    .arrows{position:absolute;bottom:10px;width:1140px;max-width:90%;display:flex;justify-content:space-between;left:50%;transform:translateX(-50%)}
    #prev,#next{width:40px;height:40px;border-radius:50%;font-family:monospace;border:1px solid #5555;font-size:large}
    #back{position:absolute;z-index:100;bottom:0;left:50%;transform:translateX(-50%);border:none;border-bottom:1px solid #555;background:transparent;padding:10px;letter-spacing:3px;font-weight:700;opacity:0;transition:opacity .5s}
    .carousel.showDetail #back{opacity:1}
    .carousel.showDetail #prev,.carousel.showDetail #next{opacity:0;pointer-events:none}
    .carousel::before{width:500px;height:300px;content:'';background-image:linear-gradient(70deg,#DC422A,blue);position:absolute;z-index:-1;border-radius:20% 30% 80% 10%;filter:blur(150px);top:50%;left:50%;transform:translate(-10%,-50%);transition:1s}
    .carousel.showDetail::before{transform:translate(-100%,-50%) rotate(90deg);filter:blur(130px)}

    @media (max-width: 991px){
      .carousel .list .item{width:90%}
      .carousel.showDetail .list .item:nth-child(2) .detail .specifications{overflow:auto}
      .carousel.showDetail .list .item:nth-child(2) .detail .title{font-size:2em}
    }
    @media (max-width: 767px){
      .carousel{height:600px}
      .carousel .list .item{width:100%;font-size:10px}
      .carousel .list{height:100%}
      .carousel .list .item:nth-child(2) .introduce{width:50%}
      .carousel .list .item img{width:40%}
      .carousel.showDetail .list .item:nth-child(2) .detail{backdrop-filter:blur(10px);font-size:small}
      .carousel .list .item:nth-child(2) .introduce .des,
      .carousel.showDetail .list .item:nth-child(2) .detail .des{height:100px;overflow:auto}
      .carousel.showDetail .list .item:nth-child(2) .detail .checkout{display:flex;width:max-content;float:right}
    }

    /* Sections */
    section{width:1140px;max-width:95%;margin:40px auto}
    .grid{display:grid;gap:20px}
    .grid.cols-3{grid-template-columns:repeat(3,1fr)}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;box-shadow:0 10px 24px rgba(0,0,0,.05)}
    .card img{width:100%;height:220px;object-fit:cover;border-radius:12px}
    .card h3{margin:10px 0 6px}
    .price{font-weight:800}
    .muted{color:#666}
    .cta{display:flex;align-items:center;gap:10px}

    @media (max-width:900px){.grid.cols-3{grid-template-columns:1fr 1fr}}
    @media (max-width:600px){.grid.cols-3{grid-template-columns:1fr}}

    /* Cart drawer */
    .drawer{position:fixed;top:0;right:-420px;width:380px;max-width:95vw;height:100dvh;background:#fff;border-left:1px solid var(--border);box-shadow:-8px 0 24px rgba(0,0,0,.08);transition:right .35s ease;z-index:1001;display:flex;flex-direction:column}
    .drawer.open{right:0}
    .drawer header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--border)}
    .drawer .content{padding:16px;overflow:auto;flex:1}
    .drawer .line{display:flex;gap:10px;align-items:center;justify-content:space-between;border-bottom:1px dashed #eee;padding:10px 0}
    .drawer .line .qty{display:flex;align-items:center;gap:6px}
    .drawer footer{padding:16px;border-top:1px solid var(--border);display:grid;gap:10px}

    /* Footer */
    footer.site{padding:40px 0;border-top:1px solid var(--border);text-align:center;color:#666}

    /* Checkout modal */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;place-items:center;z-index:1002}
    .modal.open{display:grid}
    .modal .sheet{width:520px;max-width:95vw;background:#fff;border:1px solid var(--border);border-radius:14px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
    .modal .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .modal input,.modal textarea{width:100%;padding:10px;border:1px solid var(--border);border-radius:10px}
    .modal textarea{min-height:90px}
    .modal header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="navwrap">
      <div class="logo">Lundev</div>
      <nav>
        <a href="#hero">Home</a>
        <a href="#products">Products</a>
        <a href="#contact">Contact</a>
      </nav>
      <div class="actions">
        <button class="btn" id="openCart" aria-label="Open cart">🛒 <span id="cartCount">0</span></button>
        <a class="btn primary" href="#products">Shop Now</a>
      </div>
    </div>
  </header>

  <!-- HERO / CAROUSEL -->
  <main id="hero" class="hero">
    <div class="carousel" id="carousel">
      <div class="list">
        <!-- ITEM 1 -->
        <div class="item" data-id="p1" data-name="AeroPods X" data-price="79" data-img="https://images.unsplash.com/photo-1518444032964-29596fddc3ee?q=80&w=1200&auto=format&fit=crop">
          <img src="https://images.unsplash.com/photo-1518444032964-29596fddc3ee?q=80&w=1200&auto=format&fit=crop" alt="AeroPods X wireless earbuds" />
          <div class="introduce">
            <div class="title">DESIGN SLIDER</div>
            <div class="topic">AEROPHONE</div>
            <div class="des">Premium wireless earbuds with rich bass, low-latency gaming mode, and all‑day comfort.</div>
            <button class="seeMore" data-role="seeMore">SEE MORE &#8599;</button>
          </div>
          <div class="detail">
            <div class="title">AeroPods X</div>
            <div class="des">Up to 40 hours with case • ENC dual mic for clear calls • IPX5 splash resistance • Smart touch controls • Low‑latency gaming mode.</div>
            <div class="specifications">
              <div><p>Used Time</p><p>8 hours</p></div>
              <div><p>Charging</p><p>Type‑C</p></div>
              <div><p>Compatible</p><p>iOS/Android</p></div>
              <div><p>Bluetooth</p><p>5.3</p></div>
              <div><p>Control</p><p>Touch</p></div>
            </div>
            <div class="checkout">
              <button data-role="addCart">ADD TO CART</button>
              <button data-role="checkout">CHECKOUT</button>
            </div>
          </div>
        </div>
        <!-- ITEM 2 -->
        <div class="item" data-id="p2" data-name="AeroPods Mini" data-price="59" data-img="https://images.unsplash.com/photo-1585386959984-a4155223168f?q=80&w=1200&auto=format&fit=crop">
          <img src="https://images.unsplash.com/photo-1585386959984-a4155223168f?q=80&w=1200&auto=format&fit=crop" alt="AeroPods Mini" />
          <div class="introduce">
            <div class="title">DESIGN SLIDER</div>
            <div class="topic">AEROPHONE</div>
            <div class="des">Compact yet powerful. Snug fit with vibrant sound and fast pairing.</div>
            <button class="seeMore" data-role="seeMore">SEE MORE &#8599;</button>
          </div>
          <div class="detail">
            <div class="title">AeroPods Mini</div>
            <div class="des">Featherweight design • 6 hrs playback • Quick charge 10 min → 1.5 hrs • Game mode.</div>
            <div class="specifications">
              <div><p>Used Time</p><p>6 hours</p></div>
              <div><p>Charging</p><p>Type‑C</p></div>
              <div><p>Compatible</p><p>Android</p></div>
              <div><p>Bluetooth</p><p>5.3</p></div>
              <div><p>Control</p><p>Touch</p></div>
            </div>
            <div class="checkout">
              <button data-role="addCart">ADD TO CART</button>
              <button data-role="checkout">CHECKOUT</button>
            </div>
          </div>
        </div>
        <!-- ITEM 3 -->
        <div class="item" data-id="p3" data-name="AeroPods Pro" data-price="119" data-img="https://images.unsplash.com/photo-1618366712010-f4ae9c647dcb?q=80&w=1200&auto=format&fit=crop">
          <img src="https://images.unsplash.com/photo-1618366712010-f4ae9c647dcb?q=80&w=1200&auto=format&fit=crop" alt="AeroPods Pro" />
          <div class="introduce">
            <div class="title">DESIGN SLIDER</div>
            <div class="topic">AEROPHONE</div>
            <div class="des">Active noise cancelling, transparency mode, and spatial audio.</div>
            <button class="seeMore" data-role="seeMore">SEE MORE &#8599;</button>
          </div>
          <div class="detail">
            <div class="title">AeroPods Pro</div>
            <div class="des">ANC + Transparency • 30 hrs with case • Wireless charging • Low‑latency game mode.</div>
            <div class="specifications">
              <div><p>Used Time</p><p>7 hours</p></div>
              <div><p>Charging</p><p>Wireless</p></div>
              <div><p>Compatible</p><p>All</p></div>
              <div><p>Bluetooth</p><p>5.3</p></div>
              <div><p>Control</p><p>Touch</p></div>
            </div>
            <div class="checkout">
              <button data-role="addCart">ADD TO CART</button>
              <button data-role="checkout">CHECKOUT</button>
            </div>
          </div>
        </div>
        <!-- ITEM 4 -->
        <div class="item" data-id="p4" data-name="AeroPods Sport" data-price="89" data-img="https://images.unsplash.com/photo-1617001281623-0236c1f7073c?q=80&w=1200&auto=format&fit=crop">
          <img src="https://images.unsplash.com/photo-1617001281623-0236c1f7073c?q=80&w=1200&auto=format&fit=crop" alt="AeroPods Sport" />
          <div class="introduce">
            <div class="title">DESIGN SLIDER</div>
            <div class="topic">AEROPHONE</div>
            <div class="des">Ear‑hooks for a locked‑in fit. Sweat‑proof for intense workouts.</div>
            <button class="seeMore" data-role="seeMore">SEE MORE &#8599;</button>
          </div>
          <div class="detail">
            <div class="title">AeroPods Sport</div>
            <div class="des">Secure ear‑hooks • IPX6 sweat‑proof • 9 hrs battery • Punchy bass.</div>
            <div class="specifications">
              <div><p>Used Time</p><p>9 hours</p></div>
              <div><p>Charging</p><p>Type‑C</p></div>
              <div><p>Compatible</p><p>Android</p></div>
              <div><p>Bluetooth</p><p>5.3</p></div>
              <div><p>Control</p><p>Touch</p></div>
            </div>
            <div class="checkout">
              <button data-role="addCart">ADD TO CART</button>
              <button data-role="checkout">CHECKOUT</button>
            </div>
          </div>
        </div>
        <!-- ITEM 5 -->
        <div class="item" data-id="p5" data-name="AeroPods Lite" data-price="39" data-img="https://images.unsplash.com/photo-1546435770-a3e426bf472b?q=80&w=1200&auto=format&fit=crop">
          <img src="https://images.unsplash.com/photo-1546435770-a3e426bf472b?q=80&w=1200&auto=format&fit=crop" alt="AeroPods Lite" />
          <div class="introduce">
            <div class="title">DESIGN SLIDER</div>
            <div class="topic">AEROPHONE</div>
            <div class="des">Entry level price, everyday reliability. Great gift choice.</div>
            <button class="seeMore" data-role="seeMore">SEE MORE &#8599;</button>
          </div>
          <div class="detail">
            <div class="title">AeroPods Lite</div>
            <div class="des">Comfortable fit • 5 hrs listening • Clear voice mic • Type‑C.</div>
            <div class="specifications">
              <div><p>Used Time</p><p>5 hours</p></div>
              <div><p>Charging</p><p>Type‑C</p></div>
              <div><p>Compatible</p><p>Android</p></div>
              <div><p>Bluetooth</p><p>5.1</p></div>
              <div><p>Control</p><p>Touch</p></div>
            </div>
            <div class="checkout">
              <button data-role="addCart">ADD TO CART</button>
              <button data-role="checkout">CHECKOUT</button>
            </div>
          </div>
        </div>
        <!-- ITEM 6 -->
        <div class="item" data-id="p6" data-name="AeroPods Studio" data-price="149" data-img="https://images.unsplash.com/photo-1518443952241-5fefddd475bb?q=80&w=1200&auto=format&fit=crop">
          <img src="https://images.unsplash.com/photo-1518443952241-5fefddd475bb?q=80&w=1200&auto=format&fit=crop" alt="AeroPods Studio" />
          <div class="introduce">
            <div class="title">DESIGN SLIDER</div>
            <div class="topic">AEROPHONE</div>
            <div class="des">Studio‑grade tuning with lush soundstage and dual device pairing.</div>
            <button class="seeMore" data-role="seeMore">SEE MORE &#8599;</button>
          </div>
          <div class="detail">
            <div class="title">AeroPods Studio</div>
            <div class="des">Hi‑Fi drivers • Dual‑device pairing • 10 hrs battery • Case with fast charging.</div>
            <div class="specifications">
              <div><p>Used Time</p><p>10 hours</p></div>
              <div><p>Charging</p><p>Type‑C</p></div>
              <div><p>Compatible</p><p>All</p></div>
              <div><p>Bluetooth</p><p>5.3</p></div>
              <div><p>Control</p><p>Touch</p></div>
            </div>
            <div class="checkout">
              <button data-role="addCart">ADD TO CART</button>
              <button data-role="checkout">CHECKOUT</button>
            </div>
          </div>
        </div>
      </div>
      <div class="arrows">
        <button id="prev" aria-label="Previous">&lt;</button>
        <button id="next" aria-label="Next">&gt;</button>
        <button id="back">See All  &#8599;</button>
      </div>
    </div>
  </main>

  <!-- PRODUCTS GRID -->
  <section id="products">
    <h2>Best Sellers</h2>
    <div class="grid cols-3" id="productGrid"></div>
  </section>

  <!-- FEATURES -->
  <section>
    <div class="grid cols-3">
      <div class="card"><h3>Fast Shipping</h3><p class="muted">Free delivery over $50 and same‑day dispatch before 3 PM.</p></div>
      <div class="card"><h3>1‑Year Warranty</h3><p class="muted">Hassle‑free replacements on manufacturing faults.</p></div>
      <div class="card"><h3>Secure Checkout</h3><p class="muted">All payments are encrypted and PCI‑compliant.</p></div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact">
    <div class="card">
      <h2>Contact Us</h2>
      <p class="muted">Questions, wholesale, or support? Send us a message.</p>
      <form id="contactForm">
        <div class="grid" style="grid-template-columns:1fr 1fr; gap:12px">
          <input required placeholder="Full Name" name="name" class="card" style="padding:12px" />
          <input required placeholder="Email" type="email" name="email" class="card" style="padding:12px" />
        </div>
        <textarea class="card" style="margin-top:12px; width:100%; height:120px; padding:12px" placeholder="Your message..." name="message" required></textarea>
        <div class="cta" style="margin-top:10px">
          <button class="btn primary" type="submit">Send</button>
          <span id="contactMsg" class="muted"></span>
        </div>
      </form>
    </div>
  </section>

  <footer class="site">
    © <span id="year"></span> Lundev Store. All rights reserved.
  </footer>

  <!-- CART DRAWER -->
  <aside class="drawer" id="cartDrawer" aria-hidden="true" aria-label="Shopping cart">
    <header class="navwrap">
      <strong>Cart</strong>
      <button class="btn" id="closeCart">Close ✕</button>
    </header>
    <div class="content" id="cartLines"></div>
    <footer>
      <div style="display:flex; justify-content:space-between; align-items:center">
        <strong>Total</strong>
        <strong>$<span id="cartTotal">0</span></strong>
      </div>
      <button class="btn primary" id="checkoutAll">Checkout</button>
    </footer>
  </aside>

  <!-- CHECKOUT MODAL -->
  <div class="modal" id="checkoutModal" aria-hidden="true">
    <div class="sheet card">
      <header>
        <strong>Checkout</strong>
        <button class="btn" id="closeModal" aria-label="Close">✕</button>
      </header>
      <div class="row">
        <input id="ckName" placeholder="Full name" />
        <input id="ckPhone" placeholder="Phone (e.g. 964770xxxxxxx)" />
      </div>
      <input id="ckAddress" placeholder="Address" style="margin-top:10px" />
      <textarea id="ckNote" placeholder="Notes (optional)" style="margin-top:10px"></textarea>
      <div class="cta" style="margin-top:10px;justify-content:space-between">
        <span class="muted">A WhatsApp chat will open to confirm.</span>
        <button class="btn primary" id="placeOrder">Place order</button>
      </div>
    </div>
  </div>

  <script>
    /* ====== CONFIG ======
       1) الصقي رابط Web App من Google Apps Script مكان القيمة أدناه
       2) استبدلي رقم واتساب بصيغة دولية بدون + وبلا 0 في البداية
    */
    const SCRIPT_URL = 'PASTE_YOUR_APPS_SCRIPT_WEB_APP_URL_HERE';
    const WHATSAPP_PHONE = '9647705337446'; // مثال: 07705337446 => 9647705337446
  </script>

  <script>
    // ===== Carousel Logic =====
    const carousel = document.getElementById('carousel');
    const list = carousel.querySelector('.list');
    const seeMoreBtns = carousel.querySelectorAll('[data-role="seeMore"]');
    const backBtn = document.getElementById('back');
    const nextBtn = document.getElementById('next');
    const prevBtn = document.getElementById('prev');

    nextBtn.addEventListener('click', ()=> move('next'));
    prevBtn.addEventListener('click', ()=> move('prev'));

    let isMoving = false;
    function move(type){
      if(isMoving) return; isMoving = true;
      const items = Array.from(list.children);
      if(type === 'next'){
        list.appendChild(items[0]);
        carousel.classList.remove('prev');
        carousel.classList.add('next');
      }else{
        list.prepend(items[items.length-1]);
        carousel.classList.remove('next');
        carousel.classList.add('prev');
      }
      setTimeout(()=>{
        carousel.classList.remove('next');
        carousel.classList.remove('prev');
        isMoving = false;
      }, 1100);
    }

    seeMoreBtns.forEach(btn=> btn.addEventListener('click', ()=>{
      carousel.classList.add('showDetail');
    }));
    backBtn.addEventListener('click', ()=> carousel.classList.remove('showDetail'));

    // ===== Cart =====
    const openCart = document.getElementById('openCart');
    const closeCart = document.getElementById('closeCart');
    const drawer = document.getElementById('cartDrawer');
    const lines = document.getElementById('cartLines');
    const cartCount = document.getElementById('cartCount');
    const cartTotal = document.getElementById('cartTotal');

    const CART_KEY = 'lundev_cart_v1';
    const cart = JSON.parse(localStorage.getItem(CART_KEY) || '[]');

    function saveCart(){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); }
    function renderCart(){
      lines.innerHTML = '';
      let total = 0;
      cart.forEach((it, idx)=>{
        total += it.price * it.qty;
        const row = document.createElement('div');
        row.className = 'line';
        row.innerHTML = `
          <div style="display:flex; gap:10px; align-items:center">
            <img src="${it.img}" alt="${it.name}" style="width:56px;height:56px;object-fit:cover;border-radius:8px;border:1px solid #eee" />
            <div>
              <div style="font-weight:600">${it.name}</div>
              <div class="muted">$${it.price.toFixed(2)}</div>
            </div>
          </div>
          <div class="qty">
            <button class="btn" aria-label="Decrease">-</button>
            <strong>${it.qty}</strong>
            <button class="btn" aria-label="Increase">+</button>
            <button class="btn" aria-label="Remove">✕</button>
          </div>`;
        const [dec, inc, rem] = row.querySelectorAll('button');
        inc.addEventListener('click', ()=>{ it.qty++; update(); });
        dec.addEventListener('click', ()=>{ it.qty = Math.max(1, it.qty-1); update(); });
        rem.addEventListener('click', ()=>{ cart.splice(idx,1); update(); });
        lines.appendChild(row);
      });
      cartTotal.textContent = total.toFixed(2);
      const count = cart.reduce((a,b)=>a+b.qty,0);
      cartCount.textContent = count;
      if(cart.length===0){ lines.innerHTML = '<p class="muted">Your cart is empty.</p>'; }
    }
    function update(){ saveCart(); renderCart(); }
    renderCart();

    function addToCartFromEl(el){
      const item = el.closest('.item');
      const id = item.dataset.id; const name = item.dataset.name; const price = Number(item.dataset.price); const img = item.dataset.img;
      const found = cart.find(x=>x.id===id);
      if(found) found.qty++; else cart.push({id,name,price,img,qty:1});
      update();
      drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false');
    }

    // Bind add to cart buttons inside carousel details
    carousel.querySelectorAll('[data-role="addCart"]').forEach(btn=> btn.addEventListener('click', e=> addToCartFromEl(e.target)));

    // Checkout buttons inside carousel → افتح مودال مباشرة للمنتج المختار
    carousel.querySelectorAll('[data-role="checkout"]').forEach(btn=> btn.addEventListener('click', e=>{
      // ضيف المنتج أولاً للسلة ثم افتح المودال
      addToCartFromEl(e.target);
      openCheckoutModal();
    }));

    openCart.addEventListener('click', ()=>{drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false')});
    closeCart.addEventListener('click', ()=>{drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true')});

    // ===== Products Grid (same data pulled from carousel DOM) =====
    const grid = document.getElementById('productGrid');
    const itemsData = Array.from(list.children).map(it=>({
      id: it.dataset.id,
      name: it.dataset.name,
      price: Number(it.dataset.price),
      img: it.dataset.img
    }));

    itemsData.forEach(p=>{
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img src="${p.img}" alt="${p.name}">
        <h3>${p.name}</h3>
        <p class="muted">Wireless earbuds with rich sound.</p>
        <div class="cta" style="justify-content:space-between">
          <div class="price">$${p.price}</div>
          <button class="btn" aria-label="Add ${p.name} to cart">Add to cart</button>
        </div>`;
      card.querySelector('button').addEventListener('click', ()=>{
        const found = cart.find(x=>x.id===p.id);
        if(found) found.qty++; else cart.push({...p, qty:1});
        update();
        drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false');
      });
      grid.appendChild(card);
    });

    // ===== Contact (send to Sheets) =====
    document.getElementById('contactForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const fd = new FormData(e.target);
      const payload = {
        orderId: 'MSG-' + Date.now(),
        customerName: fd.get('name'),
        phone: '', address: '',
        total: 0,
        items: [],
        note: `EMAIL: ${fd.get('email')} | MESSAGE: ${fd.get('message')}`,
        source: 'contact'
      };
      sendOrderToSheet(payload);
      document.getElementById('contactMsg').textContent = 'Thanks! We will reply within 24 hours.';
      e.target.reset();
    });

    // Footer year
    document.getElementById('year').textContent = new Date().getFullYear();

    // ====== Sheets + WhatsApp helpers ======
    function buildOrder(extra = {}){
      const items = cart.map(({id,name,price,qty,img})=>({id,name,price,qty}));
      const total = cart.reduce((t,i)=> t + i.price*i.qty, 0);
      return {
        orderId: 'LD' + Date.now(),
        items, total: Number(total.toFixed(2)),
        source: 'LundevStore',
        ...extra
      };
    }

    function sendOrderToSheet(order){
      if(!SCRIPT_URL || SCRIPT_URL.includes('PASTE_YOUR_APPS_SCRIPT')){
        console.warn('SCRIPT_URL is not set. Skipping Sheets save.');
        return Promise.resolve();
      }
      return fetch(SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors', // Apps Script web app public endpoint
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(order)
      }).catch(()=>{}); // opaque response under no-cors
    }

    function openWhatsApp(order){
      if(!WHATSAPP_PHONE){ alert('WhatsApp number not set'); return; }
      const lines = order.items.map(i => `- ${i.name} ×${i.qty} = $${(i.price*i.qty).toFixed(2)}`).join('%0A');
      const txt = `طلب جديد #${order.orderId}%0A${lines}%0Aالمجموع: $${order.total}%0A%0Aالعميل: ${order.customerName || ''}%0Aالهاتف: ${order.phone || ''}%0Aالعنوان: ${order.address || ''}%0Aملاحظات: ${order.note || ''}`;
      const url = `https://wa.me/${WHATSAPP_PHONE}?text=${txt}`;
      window.open(url, '_blank');
    }

    // ====== Checkout modal control ======
    const modal = document.getElementById('checkoutModal');
    const placeOrderBtn = document.getElementById('placeOrder');
    const closeModalBtn = document.getElementById('closeModal');

    function openCheckoutModal(){ modal.classList.add('open'); modal.setAttribute('aria-hidden','false'); }
    function closeCheckoutModal(){ modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); }
    closeModalBtn.addEventListener('click', closeCheckoutModal);
    modal.addEventListener('click', (e)=>{ if(e.target === modal) closeCheckoutModal(); });

    document.getElementById('checkoutAll').addEventListener('click', ()=>{
      if(cart.length === 0){ alert('السلة فارغة'); return; }
      openCheckoutModal();
    });

    placeOrderBtn.addEventListener('click', async ()=>{
      if(cart.length === 0){ alert('السلة فارغة'); return; }
      const customerName = document.getElementById('ckName').value.trim();
      const phone = document.getElementById('ckPhone').value.trim();
      const address = document.getElementById('ckAddress').value.trim();
      const note = document.getElementById('ckNote').value.trim();

      const order = buildOrder({customerName, phone, address, note});
      await sendOrderToSheet(order);
      openWhatsApp(order);

      cart.length = 0; update();
      closeCheckoutModal();
      drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true');
      alert('تم إنشاء الطلب! تم فتح واتساب للتأكيد.');
    });
  </script>
</body>
</html>
